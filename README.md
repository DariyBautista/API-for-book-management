# insidersTestFastAPItask

# üìö API –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–Ω–∏–≥–∞–º–∏

## üî• –û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É

–î–∞–Ω–∏–π API —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–Ω–∏–≥–∞–º–∏ –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é, —Ä–æ–ª—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ CRUD-–æ–ø–µ—Ä–∞—Ü—ñ—è–º–∏ –¥–ª—è –∫–Ω–∏–≥.

### üéØ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:

#### 1Ô∏è‚É£ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –º–µ—Ö–∞–Ω—ñ–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è JWT (JSON Web Tokens) –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –º–∞—Ä—à—Ä—É—Ç—ñ–≤ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ–∞–Ω—Å–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

#### 2Ô∏è‚É£ RBAC (Role-Based Access Control)
- –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ —Ç—Ä–∏ —Ä–æ–ª—ñ:
  - **–ß–∏—Ç–∞—á**: –º–∞—î –¥–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ –¥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É –∫–Ω–∏–≥.
  - **–ü–∏—Å—å–º–µ–Ω–Ω–∏–∫**: –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ —Å–≤–æ—ó –∫–Ω–∏–≥–∏.
  - **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**: –º–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–Ω–∏–≥–∞–º–∏ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–ª—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

#### 3Ô∏è‚É£ CRUD –¥–ª—è –∫–Ω–∏–≥
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è, –ø–µ—Ä–µ–≥–ª—è–¥, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–Ω–∏–≥:
  - –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–Ω–∏–≥–∏.
  - –ü–µ—Ä–µ–≥–ª—è–¥ —Å–ø–∏—Å–∫—É –∫–Ω–∏–≥.
  - –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–Ω–∏–≥–∏.
  - –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–Ω–∏–≥.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

- **FastAPI** ‚Äì –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –±–µ–∫–µ–Ω–¥—É.
- **SQLAlchemy** ‚Äì ORM –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö.
- **Alembic** ‚Äì –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—è–º–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- **PostgreSQL** ‚Äì –æ—Å–Ω–æ–≤–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É

1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π:
   ```bash
   pip install -r requirements.txt
   ```

2. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è alembic:
   ```bash
   alembic init alembic
   ```
3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è alembic.ini  
   –∑–º—ñ–Ω–∏—Ç–∏ –ø—ñ–¥ —Å–≤–æ—é –±–∞–∑—É –¥–∞–Ω–∏—Ö
   ```bash
   sqlalchemy.url = postgresql://username:password@localhost/DBname
   ```
4. –û–Ω–æ–≤–ª—é—î–º–æ alembic/env.py
   ```bash
   from app.models import Base  
   from app.database import DATABASE_URL  

   config.set_main_option("sqlalchemy.url", DATABASE_URL)  
   target_metadata = Base.metadata  
   ```
5. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π
   ```bash
   alembic revision --autogenerate -m "Initial migration"
   ```
   ```bash
   alembic upgrade head
   ```
6. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   uvicorn app.main:app --reload
   ```

---

## üîó –ï–Ω–¥–ø–æ–π–Ω—Ç–∏ API

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è

#### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
**POST** `/auth/register`

üìå **–ó–∞–ø–∏—Ç:**
```json
{
  "username": "testuser",
  "email": "test@example.com",
  "password": "securepassword",
  "role": "reader"
}
```

‚úÖ **–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "id": 1,
  "username": "testuser",
  "email": "test@example.com",
  "role": "reader"
}
```

#### –õ–æ–≥—ñ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
**POST** `/auth/login`

üìå **–ó–∞–ø–∏—Ç:**
```json
{
  "username": "admin",
  "password": "your_password"
}
```

‚úÖ **–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

‚ö†Ô∏è –î–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ JWT —Ç–æ–∫–µ–Ω —É –∑–∞–≥–æ–ª–æ–≤–∫—É —É —Ñ–æ—Ä–º–∞—Ç—ñ:
```
'Authorization': 'Bearer <JWT_TOKEN>'
```

---

### üìö –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–Ω–∏–≥–∞–º–∏

#### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–∏–≥–∏
**POST** `/books/`

üìå **–ó–∞–ø–∏—Ç:**
```json
{
  "title": "The Great Gatsby",
  "author": "F. Scott Fitzgerald",
  "description": "A novel set in the Roaring Twenties.",
  "published_date": "1925-04-10"
}
```

‚úÖ **–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "id": 1,
  "title": "The Great Gatsby",
  "author": "F. Scott Fitzgerald",
  "description": "A novel set in the Roaring Twenties.",
  "published_date": "1925-04-10",
  "owner_id": 1
}
```

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É –∫–Ω–∏–≥
**GET** `/books/`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω —É –∑–∞–≥–æ–ª–æ–≤–∫—É )

‚úÖ **–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
[
  {
    "id": 1,
    "title": "The Great Gatsby",
    "author": "F. Scott Fitzgerald",
    "description": "A novel set in the Roaring Twenties.",
    "published_date": "1925-04-10"
  }
]
```

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –∫–Ω–∏–≥–∏
**GET** `/books/{book_id}`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω —É –∑–∞–≥–æ–ª–æ–≤–∫—É)

#### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–Ω–∏–≥–∏
**PUT** `/books/{book_id}`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω —É –∑–∞–≥–æ–ª–æ–≤–∫—É)
```json
{
  "title": "The Great Gatsby",
  "author": "F. Scott Fitzgerald",
  "description": "A novel set in the Roaring Twenties.",
  "published_date": "2002-06-06"
}
```

#### –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–Ω–∏–≥–∏
**DELETE** `/books/{book_id}`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω —É –∑–∞–≥–æ–ª–æ–≤–∫—É)

---

### üë§ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (–¥–ª—è —Ä–æ–ª—ñ **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**)

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
**GET** `/users/`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞** —É –∑–∞–≥–æ–ª–æ–≤–∫—É)

#### –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
**PUT** `/users/{user_id}/role`

üìå üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞** —É –∑–∞–≥–æ–ª–æ–≤–∫—É)
```json
{
  "role": "writer"
}
```

#### –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
**DELETE** `/users/{user_id}`

üìå **–ó–∞–ø–∏—Ç:** (JWT —Ç–æ–∫–µ–Ω **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞** —É –∑–∞–≥–æ–ª–æ–≤–∫—É)

---

**–ü—Ä–æ–µ–∫—Ç –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!**


